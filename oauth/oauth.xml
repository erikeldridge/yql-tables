<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
	<meta>
		<author>Erik Eldridge</author>
		<sampleQuery>select * from {table} where uri='http://example.com' and key='asd123' and secret='zxc456' and cback='http://example.com';</sampleQuery>
	</meta>
	<bindings>
		<select itemPath="" produces="XML">
			<inputs>
				<key id="uri" type="xs:string" paramType="variable" required="true"/>
				<key id="key" type="xs:string" paramType="variable" required="true"/>
				<key id="secret" type="xs:string" paramType="variable" required="true"/>
				<key id="cback" type="xs:string" paramType="variable"/>
			</inputs>
			<execute><![CDATA[
			
			y.include( "http://github.com/yql/yql-tables/raw/master/oauth/oauth.utils.js" );
			y.include( 'http://github.com/kvz/phpjs/raw/master/functions/url/parse_url.js' );
			
			var parsed = parse_url( uri );
			var accessor = {
				consumerSecret: secret,
				consumerKey: key,
				tokenSecret: "",
				realm: parsed['scheme'] + '://' + parsed['host']
			};
			var args = {
				accessor: accessor,
				parameters:[]
			};
			
			if ( cback ) {
				args.parameters.push( ["oauth_callback", cback] );
			}
			
			var request = y.rest( uri );
			response.object = sendRequest( args );

      ]]></execute>
		</select>
	</bindings>
</table>
